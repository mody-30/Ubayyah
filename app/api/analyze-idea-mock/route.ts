import { NextResponse } from "next/server"

// This is a mock API route that returns a pre-defined response
// Use this for testing when the OpenAI API is not working
export async function POST(request: Request) {
  try {
    const { idea } = await request.json()

    if (!idea || idea.trim() === "") {
      return NextResponse.json({ error: "الرجاء إدخال فكرة المشروع" }, { status: 400 })
    }

    // Simulate API delay
    await new Promise((resolve) => setTimeout(resolve, 2000))

    // Return a mock analysis result
    const mockResult = `
1. **وصف المشروع:**  
${idea} هو مشروع يهدف إلى تقديم حلول مبتكرة للمستخدمين في المملكة العربية السعودية. يتميز المشروع بأهميته في تلبية احتياجات السوق المحلي وتقديم خدمات عالية الجودة.

2. **خطة التنفيذ (3 خطوات):**  
- خطوة 1: إجراء دراسة السوق وتحليل المنافسين  
- خطوة 2: تطوير النموذج الأولي للمنتج/الخدمة  
- خطوة 3: إطلاق حملة تسويقية وبدء العمليات التجارية  

3. **فرص السوق:**  
يشهد السوق السعودي نمواً بنسبة 15% سنوياً في هذا القطاع. تقدر قيمة السوق بحوالي 5 مليار ريال سعودي، مع توقعات بالوصول إلى 8 مليار بحلول عام 2025.

4. **التحديات:**  
- المنافسة القوية من الشركات القائمة
- تحديات التمويل الأولي
- الحاجة إلى بناء الوعي بالعلامة التجارية

يمكن تجاوز هذه التحديات من خلال التركيز على الميزة التنافسية الفريدة، والبحث عن مستثمرين استراتيجيين، وتنفيذ استراتيجية تسويقية مبتكرة.

5. **الجمهور المستهدف:**  
الفئة العمرية: 25-45 سنة
الخصائص: مهتمون بالتكنولوجيا، دخل متوسط إلى مرتفع، يقيمون في المدن الرئيسية بالمملكة
يمكن الوصول إليهم من خلال وسائل التواصل الاجتماعي، والإعلانات المستهدفة، والشراكات مع المؤثرين.

6. **الخطة التسويقية (بداية المشروع):**  
- الشهر الأول: إطلاق حملة على وسائل التواصل الاجتماعي وبناء حضور رقمي قوي
- الشهر الثاني: تنفيذ برنامج إحالة للعملاء وتقديم عروض ترويجية للمستخدمين الأوائل
- الشهر الثالث: عقد شراكات استراتيجية مع الشركات ذات الصلة وتنظيم فعاليات تعريفية

7. المنافسين:

| الاسم | نقطة القوة | نقطة الضعف | نوع الخدمة |
|------|-------------|-------------|-------------|
| شركة أ | سمعة قوية في السوق | أسعار مرتفعة | خدمات شاملة |
| شركة ب | تكنولوجيا متطورة | تغطية جغرافية محدودة | خدمات متخصصة |
| شركة ج | قاعدة عملاء واسعة | بطء في الابتكار | خدمات أساسية |

8. **تحليل SWOT:**  
- نقاط القوة: نموذج عمل مبتكر، فريق متخصص، تكلفة تشغيلية منخفضة  
- نقاط الضعف: علامة تجارية جديدة، محدودية الموارد المالية، قلة الخبرة في السوق  
- الفرص: سوق نامي، دعم رؤية 2030، إمكانية التوسع الإقليمي  
- التهديدات: منافسة شديدة، تغيرات تنظيمية محتملة، تقلبات اقتصادية  

9. **توصيات نهائية:**  
- التركيز على بناء علاقات قوية مع العملاء الأوائل
- الاستثمار في التكنولوجيا لتحقيق ميزة تنافسية
- تطوير استراتيجية توسع مرحلية
- الاهتمام بجمع بيانات السوق وتحليلها باستمرار
- البحث عن فرص الشراكة مع الجهات الحكومية ضمن مبادرات رؤية 2030

10. **شكل إحصائي عن المشروع:**
نمو السوق المستهدف (2023-2027):
2023: 5 مليار ريال
2024: 5.8 مليار ريال
2025: 6.7 مليار ريال
2026: 7.5 مليار ريال
2027: 8.6 مليار ريال
`

    return NextResponse.json({ result: mockResult })
  } catch (error: any) {
    console.error("Mock API Error:", error)
    return NextResponse.json(
      {
        error: "حدث خطأ في واجهة API التجريبية",
        details: error.message || "Unknown error",
      },
      { status: 500 },
    )
  }
}
